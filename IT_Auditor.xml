<?xml version="1.0" encoding="UTF-8"?>
<AccessPolicies version="1.0">
  <Meta>
    <Sector>Financial</Sector>
    <Timezone>Europe/London</Timezone>
    <Definitions>
      <StandardBusinessHours>Mon-Fri 08:00-18:00 BST</StandardBusinessHours>
      <ExtendedBusinessHours>Mon-Sat 07:00-19:00 BST</ExtendedBusinessHours>
      <Always>24/7</Always>
      <OutsideWindowDefault>Block</OutsideWindowDefault>
    </Definitions>
    <RegisteredLocations>
      <Location name="HOME" ip="203.0.113.10"/>
      <Location name="LONDON_OFFICE" ip="198.51.100.5"/>
    </RegisteredLocations>
    <RegisteredDevices>
      <Device>DEV-HOME-PC</Device>
      <Device>DEV-OFFICE-PC</Device>
    </RegisteredDevices>
    <UnregisteredDeviceRule>
      <ApprovalRequired>true</ApprovalRequired>
      <ApprovalBy>Manager</ApprovalBy>
      <IfApprovedPermission>ReadOnly</IfApprovedPermission>
    </UnregisteredDeviceRule>
  </Meta>

  <!-- IT Auditor: create/write/delete/export are denied globally -->
  <Policy>
    <Role>IT Auditor</Role>
    <Operation>Create</Operation>
    <Resource>Any</Resource>
    <Decision>Deny</Decision>
    <RiskLevel>High</RiskLevel>
    <RiskScore>9</RiskScore>
    <TimeWindow>Always</TimeWindow>
  </Policy>

  <Policy>
    <Role>IT Auditor</Role>
    <Operation>Write</Operation>
    <Resource>Any</Resource>
    <Decision>Deny</Decision>
    <RiskLevel>High</RiskLevel>
    <RiskScore>9</RiskScore>
    <TimeWindow>Always</TimeWindow>
  </Policy>

  <Policy>
    <Role>IT Auditor</Role>
    <Operation>Delete</Operation>
    <Resource>Any</Resource>
    <Decision>Deny</Decision>
    <RiskLevel>High</RiskLevel>
    <RiskScore>9</RiskScore>
    <TimeWindow>Always</TimeWindow>
  </Policy>

  <Policy>
    <Role>IT Auditor</Role>
    <Operation>Export</Operation>
    <Resource>Any</Resource>
    <Decision>Deny</Decision>
    <RiskLevel>High</RiskLevel>
    <RiskScore>10</RiskScore>
    <TimeWindow>Always</TimeWindow>
  </Policy>

  <!-- IT Auditor: READ access (Allow) where required by tests -->

  <!-- Logs: A-1, A-2, A-4 -> Allow read of system logs during Extended hours -->
  <Policy>
    <Role>IT Auditor</Role>
    <Operation>Read</Operation>
    <Resource>System Logs</Resource>
    <Decision>Allow</Decision>
    <RiskLevel>Medium</RiskLevel>
    <RiskScore>5</RiskScore>
    <TimeWindow>ExtendedBusinessHours</TimeWindow>
    <Conditions>
      <RiskAllowed>negligible,low,medium</RiskAllowed>
      <LocationControl>
        <AllowedDevices>
          <Device>DEV-HOME-PC</Device>
          <Device>DEV-OFFICE-PC</Device>
        </AllowedDevices>
        <OtherDevices>
          <ApprovalRequired>true</ApprovalRequired>
          <ApprovalBy>Manager</ApprovalBy>
          <GrantedPermission>ReadOnly</GrantedPermission>
        </OtherDevices>
      </LocationControl>
    </Conditions>
  </Policy>

  <!-- Audit reports: A-3 -> Allow read of audit files during Extended hours -->
  <Policy>
    <Role>IT Auditor</Role>
    <Operation>Read</Operation>
    <Resource>Audit Files</Resource>
    <Decision>Allow</Decision>
    <RiskLevel>Medium</RiskLevel>
    <RiskScore>5</RiskScore>
    <TimeWindow>ExtendedBusinessHours</TimeWindow>
    <Conditions>
      <RiskAllowed>negligible,low,medium</RiskAllowed>
      <LocationControl>
        <AllowedDevices>
          <Device>DEV-HOME-PC</Device>
          <Device>DEV-OFFICE-PC</Device>
        </AllowedDevices>
        <OtherDevices>
          <ApprovalRequired>true</ApprovalRequired>
          <ApprovalBy>Manager</ApprovalBy>
          <GrantedPermission>ReadOnly</GrantedPermission>
        </OtherDevices>
      </LocationControl>
    </Conditions>
  </Policy>
</AccessPolicies>
